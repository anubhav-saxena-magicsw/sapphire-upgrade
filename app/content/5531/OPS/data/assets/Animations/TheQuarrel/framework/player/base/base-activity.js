define(["marionette","player/events/eventsconst","player/constants/errorconst"],function(t,i,o){var e;return e=Backbone.Marionette.Layout.extend({className:"defaultActivityStyle",ActivityEventConst:i,strActivityName:void 0,nActivityIndex:void 0,isBaseActivity:!0,isDestroyCalled:!1,nStageScale:1,localLangName:void 0,objEventController:void 0,groupName:void 0,modelName:void 0,localText:void 0,strName:void 0,allRegionData:void 0,allRegionActivityList:void 0,mComp:{},activityRegionId:void 0,objErrConst:o,toolbox:void 0,objInlineTmplDict:void 0,strRegionName:void 0,popupData:null,popupCounter:0,popupDiv_dict:{}}),e.prototype.preinitialize=function(){},e.prototype.postInitialize=function(){},e.prototype.onActivityCreationComplete=function(){},e.prototype.getRegionChangeNotification=function(){},e.prototype.onPlayerInitComplete=function(){},e.prototype.setData=function(t){this.objInlineTmplDict=t},e.prototype.setID=function(t){this.strActivityName=t},e.prototype.getID=function(){return this.strActivityName},e.prototype.initBaseActivity=function(){this.broadcastEventReceiver(this.ActivityEventConst.MANAGE_COMMON_BROADCAST_EVENT,this,"manageCommonBroadcastEvent"),this.ActivityEventConst=i},e.prototype.getToolbox=function(){return this.toolbox},e.prototype.setState=function(){},e.prototype.resetActivity=function(){},e.prototype.endActivity=function(){this.trigger(this.ActivityEventConst.ACTIVITY_END_EVENT,this)},e.prototype.jumpToActivityByIndex=function(t){this.activityIndex=t,this.trigger(this.ActivityEventConst.JUMP_TO_ACTIVITY_BY_INDEX_EVENT,this)},e.prototype.jumpToActivityByID=function(t){this.activityID=t,this.trigger(this.ActivityEventConst.JUMP_TO_ACTIVITY_BY_ID_EVENT,this)},e.prototype.launchNextActivity=function(){this.trigger(this.ActivityEventConst.ACTIVITY_GO_TO_NEXT_ACTIVITY_EVENT,this)},e.prototype.launchPreviousActivity=function(){this.trigger(this.ActivityEventConst.ACTIVITY_GO_TO_PREVIOUS_ACTIVITY_EVENT,this)},e.prototype.setEventController=function(t){this.objEventController=t},e.prototype.showHideRegionById=function(t,i){var o={};o.task=this.ActivityEventConst.SHOW_HIDE_REGION,o.type=this.ActivityEventConst.PLAYER_COMMON_TASK_EVENT,o.regionId=t,o.state=i,this.trigger(this.ActivityEventConst.PLAYER_COMMON_TASK_EVENT,o)},e.prototype.attachListener=function(t,i,o,e){this.objEventController.addEventListener(t,i,o,e)},e.prototype.deattachListener=function(t,i,o){this.objEventController.removeEventListener(t,i,o)},e.prototype.getComponent=function(t,i,o,e){var n={};n.context=t,n.strCompType=i,n.strCallback=o,n.data=e,this.trigger(this.ActivityEventConst.CREATE_COMPONENT_EVENT,n)},e.prototype.getScreenText=function(t){var i,o;return i=$(this.localText).find("text[id="+t+"]"),o=$(i[0]).text()},e.prototype.customEventDispatcher=function(t,i,o){var e={};e.data=i,e.customData=o,e.target=i,e.type=t,i.trigger(t,e)},e.prototype.broadcastEvent=function(t,i){var o={};o.eventToBroadcast=t,o.data=i,this.trigger(this.ActivityEventConst.BROADCAST_EVENT,o)},e.prototype.broadcastEventReceiver=function(t,i,o){var e={};e.eventToListen=t,e.context=i,e.callback=o,this.trigger(this.ActivityEventConst.BROADCAST_EVENT_RECEIVER,e)},e.prototype.stopBroadcastEventReceiver=function(t,i,o){var e={};e.eventToListen=t,e.context=i,e.callback=o,this.trigger(this.ActivityEventConst.STOP_BROADCAST_EVENT_RECEIVER,e)},e.prototype.playAudio=function(t,i,o,e,n,p){var s={};s.strPath=t,s.bLoop=i,s.strTrack=o,s.reload=e,s.onStart=p,s.onFinish=n,this.trigger(this.ActivityEventConst.PLAY_AUDIO,s)},e.prototype.stopAllAudio=function(t){var i={};i.bDestroy=t,this.trigger(this.ActivityEventConst.STOP_ALL_AUDIO,i)},e.prototype.restart=function(t){this.trigger(this.ActivityEventConst.RESTART_AUDIO,t)},e.prototype.pauseAudio=function(t){this.trigger(this.ActivityEventConst.PAUSE_AUDIO,t)},e.prototype.resumeAudio=function(t){this.trigger(this.ActivityEventConst.RESUME_AUDIO,t)},e.prototype.stopAudio=function(t,i){var o={};o.trackId=t,o.destroy=i,this.trigger(this.ActivityEventConst.STOP_AUDIO,o)},e.prototype.setVolume=function(t,i){this.trigger(this.ActivityEventConst.VOLUME_CHANGE,{strTrackID:t,volume:i})},e.prototype.setDefaultVolume=function(t){this.trigger(this.ActivityEventConst.DEFAULT_VOLUME_CHANGE,{volume:t})},e.prototype.showPreloader=function(){var t={};t.task=this.ActivityEventConst.SHOW_PRELOADER,t.type=this.ActivityEventConst.PLAYER_COMMON_TASK_EVENT,this.trigger(this.ActivityEventConst.PLAYER_COMMON_TASK_EVENT,t)},e.prototype.hidePreloader=function(){var t={};t.task=this.ActivityEventConst.HIDE_PRELOADER,t.type=this.ActivityEventConst.PLAYER_COMMON_TASK_EVENT,this.trigger(this.ActivityEventConst.PLAYER_COMMON_TASK_EVENT,t)},e.prototype.updatePlayerSize=function(){var t={};t.task=this.ActivityEventConst.UPDATE_PLAYER_SIZE_EVENT,t.type=this.ActivityEventConst.PLAYER_COMMON_TASK_EVENT,this.trigger(this.ActivityEventConst.PLAYER_COMMON_TASK_EVENT,t)},e.prototype.getStageScaleValue=function(){return this.nStageScale},e.prototype.getActivityListByRegion=function(t){return this.allRegionActivityList[t].slice()},e.prototype.launchActivityInRegion=function(t,i,o,e){e=void 0===e?!1:e;var n={};n.regionId=t,n.data=o,n.strActivityID=i,n.bLaunchByIndex=e,n.task=this.ActivityEventConst.LAUNCH_ACTIVITY_IN_REGION,n.type=this.ActivityEventConst.PLAYER_COMMON_TASK_EVENT,this.trigger(this.ActivityEventConst.PLAYER_COMMON_TASK_EVENT,n)},e.prototype.getLanguageName=function(){return this.localLangName},e.prototype.removeJS=function(t){var i={};i.fileName=t+".js",i.type=this.ActivityEventConst.TYPE_JS,this.trigger(this.ActivityEventConst.REMVOE_REFERENCE,i)},e.prototype.removeCSS=function(t){var i={};i.fileName=t+".css",i.type=this.ActivityEventConst.TYPE_CSS,this.trigger(this.ActivityEventConst.REMVOE_REFERENCE,i)},e.prototype.setDrawingCanvas=function(t){this.trigger(this.ActivityEventConst.SET_DRAWING_CANVAS,t)},e.prototype.getInlineTemplateById=function(t){return this.objInlineTmplDict[t]},e.prototype.createRegion=function(t){var i={};i[t]="#"+t,void 0!==this.regions[t]?console.warn(t+o.ACTIVITY_ALREADY_REGISTERED):this.addRegions(i)},e.prototype.launchAsPopup=function(t,i,o,e,n,p){var s,r,a,v,c,E=this,u="#"+i,y=this.getInlineTemplateById("screenPopupBlockerDiv");void 0===this.popupDiv_dict[t]&&(s=$(this.getInlineTemplateById(t)).attr("class"),y=this.getInlineTemplateById("screenPopupBlockerDiv"),this.popupData={},o===!0&&(v=$(y),$("#"+i).append(v),this.popupData.blockerDiv=v),y=this.getInlineTemplateById(t),this.popupData.templateId=t,this.popupData.popupRef=$(y),this.popupData.targetArea=$("#"+i),this.popupData.popupParent=u,n?this.popupData.popupRef.hide().appendTo(this.popupData.targetArea).show().animate(n,parseInt(n.duration)):this.popupData.popupRef.hide().appendTo(this.popupData.targetArea).show(),E.onPopupAddedInDom(E.popupData),o===!0&&(this.popupCounter=this.popupCounter+1,v.attr("id",v.attr("id")+this.popupCounter),this.popupData.blockerDiv=v),void 0!==p&&void 0!==p.styleClass&&(v.removeClass(),v.addClass(p.styleClass)),this.popupData.popupRef.attr("tempId",this.popupData.templateId),this.popupData.objClassRef=this,this.popupDiv_dict[t]=this.popupData,void 0!==e&&(a=t+"___"+e,c="#"+e,r=$("#"+e,"#"+this.popupData.popupRef.attr("id")),r.attr("id",a),r.on("click",function(t){$(t.target).off("click"),E.removePopupWindow(t.target.id.split("___")[0])}),E.popupDiv_dict[t].strCloseId=a))},e.prototype.onPopupAddedInDom=function(){},e.prototype.onPopupClose=function(){},e.prototype.removeAllPopupWindow=function(){var t=this;_.filter(this.popupDiv_dict,function(i){t.removePopupWindow(i.templateId)})},e.prototype.closePopup=function(t){var i=t.data.objClassRef;i.removePopupWindow(t.data.templateId)},e.prototype.removePopupWindow=function(t){if(void 0!==t){var i,o=this;i=this.popupDiv_dict[t],void 0!==i&&null!==i&&(o.onPopupClose(i.templateId),void 0!==i.strCloseId&&$("#"+i.strCloseId,$(i.popupRef)).off("click"),i.popupRef.remove(),(null!==i.blockerDiv||void 0!==i.blockerDiv)&&($(i.blockerDiv).css("display","none"),$(i.blockerDiv).remove()),this.popupDiv_dict[t]=null,delete this.popupDiv_dict[t])}},e.prototype.manageCommonBroadcastEvent=function(t){if(this.strRegionName===t.data.region){var i;switch(t.type){case this.ActivityEventConst.MANAGE_COMMON_BROADCAST_EVENT:switch(t.data.subTask){case this.ActivityEventConst.CALL_AND_UPDATE_COMPONENT:i="self"===t.data.targetId?this:this[t.data.targetId],i[t.data.methodName].apply(this,t.data.params)}}}},e.prototype.destroy=function(t){if(this.removeAllPopupWindow(),t!==!0)throw new Error(o.DESTROY_NOT_IMPLMENENTED_IN_CHILD_CLASS);return this.isDestroyCalled=!0,this.isDestroyCalled},e});