define(["marionette","player/base/base-item-comp"],function(e,r){var t=r.extend({template:_.template(""),members:{rows:1,cloumns:1,startIndex:0,gridId:void 0,placeHolderId:void 0},$template:void 0,$placeHolder:void 0,arrViews:[],arrPlaceHolders:[],currentGridView:[-1],initialize:function(e){if(isNaN(parseInt(e.rows))||(this.members.rows=parseInt(e.rows)),isNaN(parseInt(e.columns))||(this.members.columns=parseInt(e.columns)),isNaN(parseInt(e.startIndex))||(this.members.startIndex=parseInt(e.startIndex)),$(String(e.placeHolderId)).length>0&&(this.members.placeHolderId=String(e.placeHolderId)),!($(String(e.gridId)).length>0))throw new Error("Template undefined!!!");this.members.gridId=String(e.gridId)},onRender:function(){this.$template=$(this.members.gridId).hide(),this.$placeHolder=$(this.members.placeHolderId).clone().css({position:"absolute",width:"100%",height:"100%"}),this.collectViews(),this.arrangeGridViews(),this.$template=$(this.members.gridId).show()}});return t.prototype.Super=r,t.prototype.collectViews=function(){var e=this;_.each(this.$template.children(),function(r,t){"DIV"==r.tagName&&($(r).prop("iclass",$(r).attr("class")),$(r).prop("index",t),e.arrViews.push($(r).hide()),$(r).off("click").on("click",$.proxy(e.handleViewClick,e)))})},t.prototype.handleViewClick=function(e){this.customEventDispatcher("viewClicked",this,e)},t.prototype.changeRowColumns=function(e){isNaN(parseInt(e.rows))||(this.members.rows=parseInt(e.rows)),isNaN(parseInt(e.columns))||(this.members.columns=parseInt(e.columns)),this.arrangeGridViews()},t.prototype.arrangeGridViews=function(){var e,r,t,i,s,n,o,a,h,d,l,c=this;for(s=this.members.rows,n=this.members.columns,i=s*n,a=100/n,h=100/s,e=this.members.startIndex,$.each(this.arrViews,function(e,r){r.hide()}),$.each(this.arrPlaceHolders,function(e,r){r.remove()}),this.arrPlaceHolders=[],d={width:a+"%",height:h+"%",position:"relative","float":"left",margin:"auto",border:"none"},t=0;s>t;t+=1)for(r=0;n>r;r+=1)e<this.arrViews.length&&(o=this.arrViews[e],void 0!==o.prop("iclass")&&o.attr("class",o.prop("iclass")),o.addClass(" grid_row"+t+"_col"+r),o.css(d)),l=this.$placeHolder.clone(),l.css(d).show(),this.$template.append(l),this.arrPlaceHolders.push(l),e+=1,this.currentGridView.length===e&&this.currentGridView.push(-1);for(;this.currentGridView.length>i;)this.currentGridView.pop();$.each(this.currentGridView,function(e,r){-1!==r&&(c.currentGridView[e]=-1,c.showView(r))})},t.prototype.showView=function(e){var r,t,i,s;for(s=0;s<this.currentGridView.length;s+=1)if(this.currentGridView[s]===e)return;for(s=0;s<this.currentGridView.length;s+=1)if(-1===this.currentGridView[s])return i=this.arrPlaceHolders[s],r=this.arrViews[e],r.insertAfter(i),i.hide(),r.attr("style",i.attr("style")),r.show(),this.currentGridView[s]=parseInt(r.prop("index")),void 0;t=this.arrViews[this.currentGridView[this.currentGridView.length-1]],r=this.arrViews[e],r.insertAfter(t),t.hide(),r.attr("style",t.attr("style")),r.show(),this.currentGridView.pop(),this.currentGridView.push(parseInt(r.prop("index")))},t.prototype.hideView=function(e){var r,t,i;for(i=0;i<this.currentGridView.length;i+=1)if(this.currentGridView[i]===e)return t=this.arrPlaceHolders[i],r=this.arrViews[e],t.insertAfter(r),r.hide(),t.attr("style",r.attr("style")),t.show(),this.currentGridView[i]=-1,void 0},t.prototype.destroy=function(){},t});