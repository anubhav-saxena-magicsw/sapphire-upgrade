define(["marionette","player/base/base-item-comp","text!components/sectionnavigator/template/section-navigator-item-template.html"],function(t,i,e){var s=i.extend({template:_.template(e),tagName:"div",className:"col-xs-4",parentContext:null,containerWidth:0,sectionHotspot:null,activityNavigation:null,singleActivityWidth:0,initialize:function(t){this.parentContext=t.context,this.containerWidth=t.itemWidth,this.parseItemData(),this.model.on("change:selected",$.proxy(this.onHotSpotSelected,this)),this.model.on("change:activities",$.proxy(this.onActivityVisited,this))},parseItemData:function(){var t,i,e,s;for(i=this.model.get("activities"),e=i.length,t=0;e>t;t++)s=i[t],s.visited=!1,i[t]=s;this.model.get("activities",i)},onRender:function(){var t,i={},e=this;i.sectionId=e.model.get("sectionId"),t=this.model.get("activities"),i.activityId=t[0].id,this.sectionHotspot=this.$(":first-Child"),$(this.el).on("click",function(){e.model.get("selected")||(e.model.set("selected",!0),e.parentContext.trigger(this.SECTION_HOTSPOT_CLICKED,i))}),this.activityNavigation=this.$(":last-Child"),$(this.el).css("width",this.containerWidth+"px"),$(this.sectionHotspot).addClass(this.model.get("hotspotClass")),$(this.activityNavigation).addClass(this.model.get("trackerClass")),$(this.activityNavigation).css("width","0px")},onShow:function(){var t,i;t=$(this.sectionHotspot).width(),i=this.model.get("activities").length,$(this.activityNavigation).css("left",t/2+"px"),this.singleActivityWidth=(this.containerWidth-t)/i,this.updateHotpotState(),this.updateActivityTrackerState()},onHotSpotSelected:function(){this.updateHotpotState()},onActivityVisited:function(){this.updateActivityTrackerState()},updateVisitedActivity:function(t){var i,e,s,o;for(e=this.model.get("activities"),s=e.length,i=0;s>i;i++)o=e[i],o.id===t&&(o.visited=!0,e[i]=o);this.model.get("activities",e)},updateHotpotState:function(){this.model.get("selected")?($(this.sectionHotspot).addClass("active"),this.updateActivityTrackerState()):$(this.sectionHotspot).removeClass("active")},updateActivityTrackerState:function(){var t,i,e,s,o,a=0;for(i=this.model.get("activities"),e=i.length,t=0;e>t;t++)s=i[t],s.visited&&a++;a>0&&(o=a*this.singleActivityWidth,$(this.activityNavigation).css("width",o+$(this.sectionHotspot).width()/2+"px"))}});return s.prototype.SECTION_HOTSPOT_CLICKED="sectionHotSpotClicked",s});