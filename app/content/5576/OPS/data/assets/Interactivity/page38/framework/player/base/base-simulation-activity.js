define(["player/base/base-activity","player/controllers/media-controller"],function(e,t){var o;return o=e.extend({objSimPictor:void 0,type:"simulation",nScreenIndex:0,nTotalScreen:0,screenEventName:void 0,bGlobalControls:!1,bGlobalComponents:!1,objScreen:null,initialize:function(){console.log("base simulation activity initialized")}}),o.prototype.moveToNextScreen=function(){var e=this.nScreenIndex;return e=this.nScreenIndex+1,e>=this.nTotalScreen?(e=this.nTotalScreen-1,void 0):(this.launchScreen(e),void 0)},o.prototype.moveToPreviousScreen=function(){console.log("move to pre screen...");var e=this.nScreenIndex;return e-=1,0>e?(e=0,!1):(this.launchScreen(e),void 0)},o.prototype.jumpToScreenByIndex=function(e){return 0>e&&e>=this.nTotalScreen?(console.warn("Provided screen index is not within range!!!!!"),!1):(this.launchScreen(e),void 0)},o.prototype.resetScreen=function(){this.launchScreen(this.nScreenIndex)},o.prototype.launchScreen=function(e){var t=this.endCurrentScreen(),o=this.ActivityEventConst.MIDDLE_SCREEN_LOAD_EVENT;if(this.screenEventName=o,this.removeAllPopupWindow(),t!==!0)throw new Error(this.objErrConst.ERROR_OCCURED_WHILE_DESTROYING_SCREEN_AND_ITS_EVENTS);this.nScreenIndex=e,this.startScreenInitlization()},o.prototype.startScreenInitlization=function(){var e={};e.activityRef=this,this.nTotalScreen=this.jsonData.screens.length,e.jsonData=this.jsonData.screens[this.nScreenIndex],void 0===e.jsonData.jsonSource?(e.template=this.objInlineTmplDict,this.objSimPictor.initalize(e,this)):this.loadScreenData(e.jsonData.jsonSource)},o.prototype.loadScreenData=function(e){this.loadJSONData(e,"json","application/json","json",this.onScreenJSONLoadComplete,this.dataLoadErrorHandler)},o.prototype.onScreenJSONLoadComplete=function(e,t){t.jsonData.screens[t.nScreenIndex]=e,t.objDataLoader.off(t.objDataLoader.DATA_LOAD_SUCCESS),t.objDataLoader.off(t.objDataLoader.DATA_LOAD_FAILED),t.startScreenInitlization()},o.prototype.onScreenJSONLoadFailed=function(){throw this.objDataLoader.off(this.objDataLoader.DATA_LOAD_SUCCESS),this.objDataLoader.off(this.objDataLoader.DATA_LOAD_FAILED),new Error(this.objErrConst.ERROR_WHILE_LOADING_FILE)},o.prototype.loadJSONData=function(e,t,o,n,i,r){var a=this;this.objDataLoader.on(this.objDataLoader.DATA_LOAD_SUCCESS,i),this.objDataLoader.on(this.objDataLoader.DATA_LOAD_FAILED,r),this.objDataLoader.load({url:e,dataType:t,contentType:o,returnType:n,scope:a})},o.prototype.onScreenChangeComplete=function(){var e={};e.type=this.ActivityEventConst.PLAYER_COMMON_TASK_EVENT,e.task=this.ActivityEventConst.MANAGE_NEXT_BACK_NEVIGATION_BUTTON,e.isFirstScreen=0===this.nScreenIndex,e.screenIndex=this.nScreenIndex,e.controls=this.getNavButtonData(),e.isLastScreen=this.nTotalScreen-1===this.nScreenIndex,this.trigger(this.ActivityEventConst.PLAYER_COMMON_TASK_EVENT,e)},o.prototype.initlizeControls=function(){this.bGlobalControls=void 0!==this.jsonData.controls,this.bGlobalComponents=void 0!==this.jsonData.globalComponents},o.prototype.endCurrentScreen=function(){return this.objSimPictor.destroyCurrentScreen()},o.prototype.getNavButtonData=function(){var e,t,o,n=[];for(t=this.jsonData.controls.nevigation.buttons,e=0;e<t.length;e+=1)o={},o.id=t[e].id,o.region=t[e].region,o.method=t[e].methodName,o.param="nextButton"===t[e].type?"isFirstScreen":"isLastScreen",n.push(o);return o={},o.id=this.jsonData.controls.nevigation.id,o.region=this.jsonData.controls.nevigation.region,o.method=this.jsonData.controls.nevigation.methodName,o.param="screenIndex",n.push(o),n},o.prototype.updateNevigationControl=function(e){return void 0===this.objScreen[e.id]?(console.warn(e.id+" not found!!!!!"),void 0):(this.objScreen[e.id][e.method].apply(this.objScreen[e.id],[e.param]),void 0)},o.prototype.setStageValue=function(e){this.nScaleValue=e,void 0!==this.objSimPictor&&this.objSimPictor.setStageScaleValue(this.nScaleValue)},o.prototype.onScreenChangEvent=function(e){this.launchScreen(e.screenIndex)},o.prototype.toggleMedia=function(e){e===!0?t.getInstance().pauseAllMedia():t.getInstance().resumeAllMedia()},o.prototype.setLocalText=function(){},o.prototype.onPopupClose=function(e){void 0!==this.objScreen.onPopupClose?this.objScreen.onPopupClose(e):void 0!==this.objScreenHelper.onPopupClose&&this.objScreenHelper.onPopupClose(e)},o.prototype.onPopupAddedInDom=function(e){void 0!==this.objScreenHelper.onPopupAddedInDom&&this.objScreenHelper.onPopupAddedInDom(e)},o.prototype.__super__=e,o.prototype.destroy=function(e){return this.__super__.prototype.destroy(e)},o});