define(["marionette","player/base/base-composite-comp","text!components/lifemeter/template/lifemeter.html","css!components/lifemeter/template/css/lifemeter.css","components/lifemeter/model/lifemeter-model","components/lifemeter/js/life","components/lifemeter/js/lifemeter-constants"],function(e,t,o,i,l,r,s){var n=t.extend({template:_.template(o),itemView:r,tagName:"div",className:"lifeMeterLayout",initialize:function(e){this.model=new l,this.initializeModel(e);var t,o,i,r,s,n,m,a;for(t=Backbone.Model.extend({defaults:{lifeclass:"",state:1}}),o=Backbone.Collection.extend({model:t}),i=this.getFromModel("arrLifeModels"),r=this.getFromModel("iconClasses"),s=0;s<this.getFromModel("total");s+=1)n="",s<r.length?n=r[s]:(m=s%r.length,n=r[m]),a=new t({lifeclass:n,state:1}),i.push(a);this.collection=new o(i),i=null},onRender:function(){},onShow:function(){var e=this;this.$el.on("click",$.proxy(e.compClick,e)),this.$el.on("mouseover",$.proxy(e.compRollover,e)),this.$el.on("mouseout",$.proxy(e.compRollout,e))},baseClass:t});return n.prototype.Super=t,n.prototype.loseLife=function(){var e,t,o;return this.getFromModel("remaining")<=0?(console.error("No More Lives available"),void 0):(this.setToModel("remaining",this.getFromModel("remaining")-1),e=this.getFromModel("arrLifeModels"),t=0,t=this.getFromModel("changeOrder")===s.CONSTANTS.CHANGE_ORDER_DESCENDING?this.getFromModel("remaining"):this.getFromModel("total")-(this.getFromModel("remaining")+1),o=e[t],o.set("state",0),0===this.getFromModel("remaining")&&this.trigger(s.EVENTS.LIFE_ENDED),void 0)},n.prototype.gainLife=function(){var e,t,o;if(!(this.getFromModel("remaining")<this.getFromModel("total")))throw console.error("Lives cannot exceed beyond maximum."),new Error("Lives cannot exceed beyond maximum.");this.setToModel("remaining",this.getFromModel("remaining")+1),e=this.getFromModel("arrLifeModels"),t=0,t=this.getFromModel("changeOrder")===s.CONSTANTS.CHANGE_ORDER_DESCENDING?this.getFromModel("remaining")-1:this.getFromModel("total")-this.getFromModel("remaining"),o=e[t],o.set("state",1),this.getFromModel("remaining")===this.getFromModel("total")&&this.trigger(s.EVENTS.LIFE_AT_MAX)},n.prototype.getRemainingLife=function(){return this.getFromModel("remaining")},n.prototype.reset=function(){var e,t,o;for(e=this.getFromModel("arrLifeModels"),t=0;t<e.length;t++)o=e[t],o.set("state",1);this.setToModel("remaining",this.getFromModel("total"))},n.prototype.initializeModel=function(e){void 0!==e.total&&(this.model.set("total",e.total),this.model.set("remaining",e.total)),void 0!==e.changeOrder&&this.model.set("changeOrder",e.changeOrder),void 0!==e.iconClasses&&this.model.set("iconClasses",e.iconClasses)},n.prototype.getFromModel=function(e){var t=this.model.get(e);return t},n.prototype.setToModel=function(e,t){this.model.set(e,t)},n.prototype.destroy=function(){var e,t,o;for(e=this,t=e.getFromModel("arrLifeModels"),e.setToModel("total",0),e.setToModel("arrlifeViewModel",[]),e.setToModel("iconClasses",[]);t.length;)o=t.pop(),e.collection.remove(o),o.destroy(),o=null;return t=null,e.model.destroy(),e.model=null,e.colection=null,this.$el.off("click"),this.$el.off("mouseover"),this.$el.off("mouseout"),this.Super.prototype.destroy(!0)},n});