define(["player/base/base-simulation-activity","player/utils/data-loader","frameworkRoot/activities/simulation-model"],function(t,o,a){var e=t.extend({template:_.template("<div>simulation activity</div>"),activityData:void 0,jsonData:void 0,objDataLoader:void 0,regions:{screenHolder:"#screenHolder",globalCompHolder:"#globalCompHolder"},initialize:function(t){this.model=new a,this.initBaseActivity(),this.activityData=t}});return e.prototype.onActivityCreationComplete=function(){this.broadcastEventReceiver(this.ActivityEventConst.MANAGE_COMMON_BROADCAST_EVENT,this,"manageCommonBroadcastEvent");var t=this.activityData;this.objDataLoader=new o,void 0!==t.dataPath&&this.loadJSONData(t.dataPath,"json","application/json","json",this.handleJsonDataLoadComplete,this.dataLoadErrorHandler),void 0!==this.localText&&this.setLocalText()},e.prototype.testMethod=function(){console.log("self method invoked...........",arguments)},e.prototype.manageCommonBroadcastEvent=function(t){if(this.strRegionName===t.data.region)switch(t.type){case this.ActivityEventConst.MANAGE_COMMON_BROADCAST_EVENT:switch(t.data.subTask){case this.ActivityEventConst.CALL_AND_UPDATE_COMPONENT:delete t.data.region,this.objSimPictor.callAndUpdateComponent(t.data)}}},e.prototype.__super__=t,e.prototype.setPictorRef=function(t){this.objSimPictor=t},e.prototype.handleJsonDataLoadComplete=function(t,o){o.jsonData=t,o.objDataLoader.off(o.objDataLoader.DATA_LOAD_SUCCESS),o.objDataLoader.off(o.objDataLoader.DATA_LOAD_FAILED),void 0!==t.defaults&&$.each(t.defaults,function(t,a){o.model.set(t,a)}),void 0!==o.activityData.stylePath?o.loadCSSData(o.activityData.stylePath):o.onAllDataLoadComplete()},e.prototype.onAllDataLoadComplete=function(){this.initlizeControls(),this.startScreenInitlization()},e.prototype.dataLoadErrorHandler=function(){throw this.objDataLoader.off(this.objDataLoader.DATA_LOAD_SUCCESS),this.objDataLoader.off(this.objDataLoader.DATA_LOAD_FAILED),new Error(this.objErrConst.ERROR_WHILE_LOADING_FILE)},e.prototype.loadCSSData=function(t){var o=this;require(["css!"+t+"?"+(new Date).getTime()],function(){o.onAllDataLoadComplete()})},e.prototype.destroy=function(){return this.screenHolder.close(),void 0!==this.activityData.stylePath&&this.removeCSS(this.activityData.stylePath.split(".css")[0]),this.objSimPictor.destroy(),delete this.objSimPictor,this.removeJS("player/base/base-simulation-activity"),this.__super__.prototype.destroy(!0)},e});